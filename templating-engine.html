<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Python Practice Projects</title>
    <meta name="description" content="Programming practice projects designed to take your Python coding chops to the next level">
    <meta name="author" content="Louie Dinh">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://pythonpracticeprojects.com/theme/html5.js"></script>
    <![endif]-->

    <!-- start Mixpanel -->
    <script type="text/javascript">
        (function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
        for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]);
        mixpanel.init("f648b3a9798e7c489b48fb616f33abfe");

        mixpanel.track("Page Visit!");
    </script>

    <!-- end Mixpanel -->

    <!-- Le styles -->
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap.no-icons.min.css" rel="stylesheet">
    <link href="http://pythonpracticeprojects.com/theme/local.css" rel="stylesheet">
    <link href="http://pythonpracticeprojects.com/theme/pygments.css" rel="stylesheet">
    <link href="http://pythonpracticeprojects.com/theme/font-awesome.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Gudea:400,400italic|Alegreya+SC' rel='stylesheet' type='text/css'>
</head>

<body>
<header class="blog-header">
  <div class="container">
    <div class="row-fluid">
      <div class="span9">
	<a href="http://pythonpracticeprojects.com" class="brand">Python Practice Projects</a>
      </div>

      <div class="span3" id="blog-nav">
	<ul class="nav nav-pills pull-right">

       <li><a href="http://www.eepurl.com/FnX4f">Subscribe</a></li>
       <li><a href="http://pythonpracticeprojects.com">Projects</a></li>
	    <li >
	      <a href="http://pythonpracticeprojects.com/category/blog.html ">Blog</a>
        </li>
	</ul>
      </div>
    </div> <!-- End of fluid row-->
  </div>   <!-- End of Container-->
</header>
    
<div class="container">
    <div class="content">
    <div class="row-fluid">

        <div class="span10">
<section id="content" class="body span10 page">
    <h1 class="content-title">Templating Engine</h1>
    <h2>Motivation</h2>
<p>A templating engine combines templates and data models to produce result documents. A good analogy
is baking cookies. You have a cookie cutter(template) and your dough(the data model). You take
your cookie cutter and, depending on the dough, you will stamp out cookies that are
related but not identical.</p>
<p>Templating engines allows you to seperate logic from presentation in a program. By splitting these two
concerns you are free to modify each piece independently. The split between logic and presentation is
well explored and serves as the primary motivation behind the popular Model-View-Controller
design pattern driving many web and mobile applications today.</p>
<p>In this practice problem, we will try to build a templating engine with a specialized syntax. Some
templating engines allow you to execute normal python code, but that dangles the carrot of model 
data mutation a little too close for comfort.</p>
<h2>Prerequisites</h2>
<p>It is helpful to have some experience using a templating engine before you start this project.
You can download one of the engines below to start experimenting. However, almost everybody has
used a basic templating engine before! Python string formatting is just a simple templating engine.</p>
<div class="highlight"><pre><span class="n">name</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">insert</span> <span class="n">your</span> <span class="n">name</span> <span class="n">here</span><span class="o">&gt;</span>
<span class="s">&quot;Hello %s, I hope you&#39;re well today&quot;</span> <span class="o">%</span> <span class="n">name</span>
</pre></div>


<h2>Problem Statement</h2>
<p>We will stick closely to the jinja2/django syntax because that is what people are most familiar with. 
If you're feeling adventerous, feel free to invent your own syntax.</p>
<p>The rendering of a template should be fairly easy. The template
should take in a dictionary that provides all the data required
to render it.</p>
<p>Here is an example of what our template should be able to do.</p>
<div class="highlight"><pre><span class="o">&gt;&gt;</span><span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;our_template.tmpl&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">))</span>
<span class="o">&gt;&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="o">:</span> <span class="s">&quot;Eva&quot;</span><span class="p">,</span> <span class="s">&quot;age&quot;</span><span class="o">:</span> <span class="mi">23</span><span class="p">,</span> <span class="s">&quot;apple_count&quot;</span><span class="o">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="o">&gt;&gt;</span><span class="n">output</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">data_model</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="o">&gt;&gt;</span><span class="n">print</span> <span class="n">output</span>

<span class="n">Hello</span> <span class="n">Eva</span><span class="p">,</span> <span class="n">what</span> <span class="n">a</span> <span class="n">fine</span> <span class="n">age</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="n">to</span> <span class="n">be</span> <span class="n">baking</span> <span class="n">apple</span> <span class="n">pies</span><span class="p">.</span> <span class="n">You</span> <span class="n">need</span> <span class="mi">7</span> <span class="n">more</span> <span class="n">apples</span> <span class="n">until</span> <span class="n">you</span> <span class="n">have</span> <span class="n">a</span> <span class="n">dozen</span><span class="p">.</span> <span class="n">Come</span> <span class="n">back</span> <span class="n">when</span> <span class="n">you</span><span class="err">&#39;</span><span class="n">re</span> <span class="n">ready</span><span class="o">!</span>

<span class="o">&gt;&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="o">:</span> <span class="s">&quot;Eva&quot;</span><span class="p">,</span> <span class="s">&quot;age&quot;</span><span class="o">:</span> <span class="mi">23</span><span class="p">,</span> <span class="s">&quot;apple_count&quot;</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;friends&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s">&quot;Billy&quot;</span><span class="p">,</span> <span class="s">&quot;John&quot;</span><span class="p">,</span> <span class="s">&quot;Emily&quot;</span><span class="p">]}</span>
<span class="o">&gt;&gt;</span><span class="n">output</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">data_model</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="o">&gt;&gt;</span><span class="n">print</span> <span class="n">output</span>

<span class="n">Hello</span> <span class="n">Eva</span><span class="p">,</span> <span class="n">what</span> <span class="n">a</span> <span class="n">fine</span> <span class="n">age</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="n">to</span> <span class="n">be</span> <span class="n">baking</span> <span class="n">apple</span> <span class="n">pies</span><span class="p">.</span> <span class="n">It</span> <span class="n">looks</span> <span class="n">like</span> <span class="n">you</span><span class="err">&#39;</span><span class="n">ve</span> <span class="n">got</span> <span class="n">a</span> <span class="n">round</span> <span class="n">dozen</span><span class="p">.</span> <span class="n">I</span><span class="err">&#39;</span><span class="n">ll</span> <span class="n">just</span> <span class="n">go</span> <span class="n">preheat</span> <span class="n">the</span> <span class="n">oven</span> <span class="n">now</span><span class="p">.</span> 
<span class="n">After</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">call</span> <span class="n">Billy</span><span class="p">,</span> <span class="n">John</span><span class="p">,</span> <span class="n">Emily</span> <span class="n">to</span> <span class="n">help</span> <span class="n">us</span> <span class="n">eat</span><span class="p">.</span>
</pre></div>


<h3>String Interpolation</h3>
<p>This is just a direct substitution of the string.</p>
<div class="highlight"><pre><span class="s">&quot;Hello {{name}}, what a fine age, {{age}}, to be baking apple pies&quot;</span>
</pre></div>


<h3>Conditionals and Comparisons</h3>
<p>Conditionals allow you to make presentation decisions based on your data.</p>
<div class="highlight"><pre><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">apple_count</span> <span class="o">&gt;=</span> <span class="mi">12</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">...</span>
<span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">...</span>
</pre></div>


<h3>Calculations</h3>
<p>Simple arithmetic should be supported within your template delimiters.</p>
<div class="highlight"><pre><span class="s">&quot;You need {{12 - apple_count}} until you have a round dozen&quot;</span>
</pre></div>


<h3>Loops</h3>
<p>You should be able to loop through lists (and maybe even dictionaries!) to show collections of data.</p>
<div class="highlight"><pre><span class="s">&quot;After, you can call {% for friend in friends %}{{friend}},{% endfor %} to help us eat.&quot;</span>
</pre></div>


<h3>Template Inheritance</h3>
<p>Inheritance allows you to factor out common elements in your page. The template hierarchy
acts similar to a class hierarchy.</p>
<p>base.templ:</p>
<div class="highlight"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">head</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}{%</span> <span class="k">end</span> <span class="nb">block</span> <span class="cp">%}</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<p>inheritance_eg.templ:</p>
<div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="nv">base.template</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">head</span> <span class="cp">%}</span>
<span class="nt">&lt;title&gt;</span>My first templated page!<span class="nt">&lt;/title&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
<span class="nt">&lt;h1&gt;</span>Hello to the templated world!<span class="nt">&lt;/h1&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>


<p>You can probably imagine what the output but here it just for completeness.</p>
<div class="highlight"><pre><span class="o">&gt;&gt;</span><span class="n">template</span> <span class="o">=</span> <span class="nx">Template</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;inheritance_eg.tmpl&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">))</span>
<span class="o">&gt;&gt;</span><span class="n">output</span> <span class="o">=</span> <span class="nx">template.render</span><span class="p">()</span>
<span class="o">&gt;&gt;</span><span class="nx">print</span> <span class="nb">output</span>

<span class="o">&lt;!</span><span class="nb">doctype</span> <span class="nx">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">head</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">title</span><span class="o">&gt;</span><span class="nx">My</span> <span class="nb">first</span> <span class="nx">templated</span> <span class="nx">page</span><span class="o">!&lt;/</span><span class="nb">title</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="nb">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">body</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="k">to</span> <span class="nx">the</span> <span class="nx">templated</span> <span class="nx">world</span><span class="o">!&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="nb">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nx">html</span><span class="o">&gt;</span>
</pre></div>


<p>That's it for your simple template engine! This is just scratching the surface, feel free to
dig into production templating engines and see how far you can take it.</p>
<h2>References</h2>
<ul>
<li><a href="http://alexmic.net/building-a-template-engine/">Toy Templating Engine</a> - Alex Michael</li>
<li><a href="http://jinja.pocoo.org/docs/">Jinja</a> - Armin Ronacher</li>
<li><a href="https://www.djangoproject.com/">Django Templates</a> - Django Project</li>
<li><a href="http://www.simple-is-better.org/template/pyratemp.html">Pyratemp</a> - Roland Koebler</li>
<li><a href="https://pypi.python.org/pypi/evoque/">Evoque</a> - Mario Ruggier</li>
</ul>
	<hr />
    Like what you just read? <a href="http://www.eepurl.com/FnX4f">Subscribe to Python Practice Projects</a> for more insights on practice, programming and the slow path to victory.
</section>
        </div>
        
        
    </div>     </div> </div>

<!--footer-->
<div class="container">
  <div class="well" style="background-color: #E9EFF6">
    <div id="blog-footer">
      <div class="row-fluid">
	<div class="social span2" align="center" id="socialist">
	  <ul class="nav nav-list">
	    <li class="nav-header">
	      Social
	    </li>
	    <li><a href="http://twitter.com/louiedinh"><i class="icon-twitter" style="color: #1f334b"></i>twitter</a></li>
	    <li><a href="http://www.linkedin.com/profile/view?id=103017614"><i class="icon-linkedin" style="color: #1f334b"></i>linkedin</a></li>

	  </ul>
	</div>
        <div class="links span2" align="center">
          <ul class="nav nav-list">
            <li class="nav-header"> 
              Links
            </li>
            
            <li><a href="http://jessenoller.com/good-to-great-python-reads/">Good to Great Python Reads</a></li>
            <li><a href="http://gnosis.cx/publish/tech_index_cp.html">Charming Python</a></li>
            <li><a href="http://www.python.org/dev/peps/pep-0008/">PEP8 - Style Guide</a></li>
            <li><a href="http://docs.python-guide.org/en/latest/">Hitchhiker's Guide to Python</a></li>
          </ul>
        </div>
	<div class="site-nav span2" align="center">
          <ul class="nav nav-list" id="site-links">
            <li class="nav-header"> 
              Site
            </li>
            <li><a href="http://pythonpracticeprojects.com"><i class="icon-home" style="color: #1f334b">
                </i>Home</a></li>
            <li><a href="http://pythonpracticeprojects.com/archives.html"><i class="icon-list" style="color: #1f334b">
                </i>Archives</a></li>
	    <li><a href="http://pythonpracticeprojects.com/tags.html"><i class="icon-tags" style="color: #1f334b">
                </i>Tags</a></li>
	    
	  </ul>

        </div>

      </div> <!--end of fluid row-->
    </div> <!--end of blog-footer-->
    <hr />
    <p align="center"><a href="http://pythonpracticeprojects.com">Python Practice Projects</a>
      &copy; Louie Dinh
    Powered by <a href="github.com/getpelican/pelican">Pelican</a> and
        <a href="https://twitter.github.com/bootstrap">Twitter Bootstrap</a>. 
        Icons by <a href="http://fortawesome.github.com/Font-Awesome">Font Awesome</a> and 
        <a href="http://gregoryloucas.github.com/Font-Awesome-More">Font Awesome More</a></p>

  </div> <!--end of well -->
</div> <!--end of container -->

<!--/footer-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>


<script>var _gaq=[['_setAccount','UA-39716444-2'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>

</body>
</html>